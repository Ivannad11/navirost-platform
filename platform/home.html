<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–ª–∞–≤–Ω–∞—è ‚Äî –Ω–∞–≤—ã—Ä–æ—Å—Ç.</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/modal.css">
    <link rel="stylesheet" href="../assets/css/sidebar.css">
    <style>
        body {
            background-color: var(--bg-secondary);
            margin: 0;
            padding: 0;
        }

        .dashboard-layout {
            display: grid;
            grid-template-columns: 260px 1fr 320px; /* sidebar, –∫–æ–Ω—Ç–µ–Ω—Ç, –ø—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ */
            gap: 24px;
            min-height: 100vh;
        }

        /* Sidebar (Reused) */
        .sidebar {
            background: white;
            border-right: 1px solid var(--border-light);
            padding: 24px 16px;
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 40px;
        }
        .sidebar-logo span { color: var(--text-secondary); }

        .nav-menu { list-style: none; flex: 1; }
        .nav-item { margin-bottom: 8px; }
        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .nav-link:hover, .nav-link.active {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        .nav-link.active { font-weight: 600; }

        /* User Profile Redesign */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-radius: 12px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            background: var(--bg-primary);
            transition: all 0.2s;
            position: relative;
            margin-top: auto; /* –ø—Ä–∏–∂–∞—Ç—å –∫ –Ω–∏–∑—É sidebar */
        }
        .user-profile:hover {
            border-color: var(--text-tertiary);
            background: white;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .user-info { flex: 1; overflow: hidden; }
        .user-name { font-size: 14px; font-weight: 600; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .user-role { font-size: 11px; color: var(--text-secondary); display: flex; align-items: center; gap: 4px; }
        .user-role::before { content: '‚óè'; color: #22C55E; font-size: 8px; }

        /* Right Sidebar */
        .right-sidebar {
            padding: 32px 24px;
            background: #fafafa;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏–∫–æ–Ω–æ–∫ */
        .icon-text {
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            color: #666;
            margin-bottom: 12px;
        }

        .stat-header {
            margin-bottom: 8px;
        }

        .stat-title {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .stat-desc {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard-layout {
                grid-template-columns: 260px 1fr;
            }
            
            .right-sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .dashboard-layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .page-header {
                flex-direction: row;
                align-items: center;
                gap: 0;
            }
            
            .header-left {
                display: none;
            }
            
            .page-title {
                text-align: left;
            }
        }

        .profile-menu {
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 8px;
            display: none;
            margin-bottom: 8px;
        }
        .profile-menu.active { display: block; animation: slideUp 0.2s ease-out; }
        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            transition: background 0.2s;
            white-space: normal; /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
            line-height: 1.4;
        }
        .menu-item:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .menu-item.danger { color: #EF4444; }
        .menu-item.danger:hover { background: #FEF2F2; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 40px;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            gap: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: #000;
            text-decoration: none;
            position: static !important;
            z-index: 10;
        }

        .page-title {
            flex: 1;
            text-align: center;
        }

        .page-title h1 { font-size: 28px; margin-bottom: 4px; }

        /* Burger Menu */
        .burger-btn {
            display: none; /* –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–∞ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ */
            background: none;
            border: none;
            width: 30px;
            height: 24px;
            position: relative;
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }

        .burger-btn span {
            display: block;
            width: 100%;
            height: 3px;
            background: var(--text-primary);
            margin-bottom: 5px;
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        .burger-btn span:last-child {
            margin-bottom: 0;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∫—Ä–µ—Å—Ç–∏–∫–∞ */
        .burger-btn.active span:nth-child(1) {
            transform: rotate(45deg) translateY(8px);
        }

        .burger-btn.active span:nth-child(2) {
            opacity: 0;
        }

        .burger-btn.active span:nth-child(3) {
            transform: rotate(-45deg) translateY(-8px);
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 6px;
            max-width: 620px;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1.35fr minmax(300px, 0.65fr);
            gap: 24px;
            align-items: start;
            grid-auto-rows: min-content;
        }

        .stack {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .card {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 20px;
            padding: 24px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .card-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 0;
        }

        .card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 16px;
        }

        .ghost-link {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            border: 1px solid var(--border-light);
            padding: 10px 12px;
            border-radius: 12px;
            background: var(--bg-primary);
            transition: all 0.2s;
        }

        .ghost-link:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Overview Stats */
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-bottom: 24px;
            grid-auto-rows: minmax(140px, auto); /* –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –º–∏–Ω–∏–º—É–º 140px –≤—ã—Å–æ—Ç–æ–π */
        }

        .stat-card {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 140px; /* —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s;
        }

.stat-card:nth-child(2) { animation-delay: 0.2s; }
.stat-card:nth-child(3) { animation-delay: 0.3s; }
.stat-card:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.03); }
        
        .stat-icon-wrapper {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 16px;
        }
        .bg-blue { background: #DBEAFE; color: #1D4ED8; }
        .bg-green { background: #DCFCE7; color: #15803D; }
        .bg-purple { background: #F3E8FF; color: #7E22CE; }

        .stat-label { font-size: 13px; color: var(--text-secondary); font-weight: 500; }
        .stat-number { font-size: 28px; font-weight: 700; color: var(--text-primary); margin-top: 4px; }
        .stat-trend { font-size: 12px; color: var(--text-tertiary); margin-top: auto; }

        /* Recent Activity / Projects */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .section-title { font-size: 18px; font-weight: 600; }
        
        .project-list {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 16px;
            overflow: hidden;
        }
        
        .project-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-light);
            transition: background 0.2s;
            cursor: pointer;
        }
        .project-item:last-child { border-bottom: none; }
        .project-item:hover { background: var(--bg-secondary); }
        
        .project-meta { display: flex; align-items: center; gap: 16px; }
        .project-avatar {
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .project-details div:first-child { font-weight: 600; color: var(--text-primary); }
        .project-details div:last-child { font-size: 13px; color: var(--text-tertiary); margin-top: 2px; }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, #FAFAFA 0%, #FFFFFF 100%);
            border: 1px dashed var(--border-light);
            border-radius: 20px;
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            display: block;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .empty-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .empty-desc {
            color: var(--text-secondary);
            margin-bottom: 32px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        @media (max-width: 1024px) {
            .overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .burger-btn {
                display: block; /* –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –º–æ–±–∏–ª–∫–µ */
            }
            
            .sidebar {
                position: fixed;
                left: -280px; /* —Å–ø—Ä—è—Ç–∞–Ω–∞ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º */
                top: 0;
                height: 100vh;
                width: 280px;
                background: white;
                box-shadow: 2px 0 8px rgba(0,0,0,0.1);
                transition: left 0.3s ease;
                z-index: 1000;
                border-right: 1px solid var(--border-light);
                padding: 24px;
                flex-direction: column;
                overflow-y: auto;
            }
            
            .sidebar.open {
                left: 0; /* –≤—ã–µ–∑–∂–∞–µ—Ç –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –±—É—Ä–≥–µ—Ä */
            }
            
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 999;
            }
            
            .overlay.active {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
            
            .page-header {
                flex-direction: row;
                align-items: center;
                gap: 0;
            }
            
            .overview-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .stat-card {
                min-height: 120px; /* –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ */
                padding: 16px;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .project-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .project-item > div:last-child {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .stat-card h3 {
                font-size: 14px; /* –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ–Ω—å—à–µ */
            }
            
            .stat-card .stat-number {
                font-size: 24px; /* —Ü–∏—Ñ—Ä–∞ –º–µ–Ω—å—à–µ */
            }
            
            .stat-card .stat-label {
                font-size: 12px;
            }
            
            .stat-card .stat-trend {
                font-size: 11px;
            }
            
            .stat-card {
                min-height: 100px; /* –º–µ–Ω—å—à–µ –Ω–∞ —Å–æ–≤—Å–µ–º –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
            }
            
            .stat-icon-wrapper {
                width: 32px;
                height: 32px;
                font-size: 16px;
                margin-bottom: 12px;
            }
            
            .page-title h1 {
                font-size: 20px;
            }
            
            .page-subtitle {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>

    <div class="dashboard-layout">
    <aside class="sidebar">
        <a href="../index.html" class="sidebar-logo">–Ω–∞–≤—ã—Ä–æ—Å—Ç<span>.</span></a>
        
        <ul class="nav-menu">
            <!-- Dynamically populated by sidebar-logic.js -->
        </ul>
        
        <div class="user-profile" id="userProfileBtn">
            <div class="avatar">–ò</div>
            <div class="user-info">
                <div class="user-name">–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</div>
                <div class="user-role">Pro Plan</div>
            </div>
            
            <div class="profile-menu" id="profileMenu">
                <div class="menu-item" onclick="window.location.href='/platform/settings.html'">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                <div class="menu-item">üí≥ –ü–æ–¥–ø–∏—Å–∫–∞</div>
                <div class="menu-item danger" onclick="logout()">üö™ –í—ã–π—Ç–∏</div>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div class="page-header">
            <button id="burger-menu" class="burger-btn" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
  <span></span>
  <span></span>
  <span></span>
</button>
            <div class="header-left">
                <a href="/platform/home.html" class="logo">–Ω–∞–≤—ã—Ä–æ—Å—Ç.</a>
            </div>
            <div class="page-title">
                <h1>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, <span id="user-name">–ì–æ—Å—Ç—å</span>!</h1>
                <div class="page-subtitle">–í–æ—Ç —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –≤–∞—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏.</div>
            </div>
            <button class="btn-primary" onclick="createNewProject()">+ –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
        </div>

        <div class="overview-grid">
            <div class="stat-card">
                <div class="stat-icon-wrapper bg-blue">üöÄ</div>
                <div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</div>
                    <div class="stat-number" id="totalProjects">0</div>
                </div>
                <div class="stat-trend">–í—Å–µ —Å–∏—Å—Ç–µ–º—ã –≤ –Ω–æ—Ä–º–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon-wrapper bg-green">üí∞</div>
                <div>
                    <div class="stat-label">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ (–ü–ª–∞–Ω)</div>
                    <div class="stat-number" id="totalRevenue">0 ‚ÇΩ</div>
                </div>
                <div class="stat-trend">–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon-wrapper bg-purple">üìà</div>
                <div>
                    <div class="stat-label">–ü—Ä–∏–±—ã–ª—å (–ü–ª–∞–Ω)</div>
                    <div class="stat-number" id="totalProfit">0 ‚ÇΩ</div>
                </div>
                <div class="stat-trend">–°—É–º–º–∞ –ø–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon-wrapper bg-blue">üéØ</div>
                <div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∞</div>
                    <div class="stat-number" id="avgMargin">0 ‚ÇΩ</div>
                </div>
                <div class="stat-trend">–ï—Å–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —é–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫–∞</div>
            </div>
        </div>

        <div class="content-grid">
            <section class="stack">
                <div class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-title">–ü—Ä–æ–µ–∫—Ç—ã</div>
                            <div class="card-subtitle">–ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–∞—Å—á–µ—Ç–∞–º –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –º–æ–¥–µ–ª–∏</div>
                        </div>
                        <button class="btn-create-project ghost-link">+ –°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                    <div id="projectsContainer">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>
        </div>
    </main>

    <aside class="right-sidebar">
        <div class="card" id="onboardingWidget" style="display:none;">
            <div class="card-header" style="margin-bottom: 12px;">
                <div>
                    <div class="card-title">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                    <div class="card-subtitle">–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —Ä–∞—Å—á–µ—Ç</div>
                </div>
                <div style="font-size: 13px; color: var(--text-tertiary);" id="onboardingPercent">0%</div>
            </div>
            <div style="height:6px; background:var(--bg-tertiary); border-radius:3px; overflow:hidden; margin-bottom:16px;">
                <div id="onboardingBar" style="height:100%; width:0%; background:var(--text-primary); transition:width 0.5s;"></div>
            </div>
            <div style="display:grid; grid-template-columns:1fr; gap:10px;">
                <div class="menu-item" id="stepProject" style="border:1px solid var(--border-light);">1Ô∏è‚É£ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</div>
                <div class="menu-item" id="stepUnit" style="border:1px solid var(--border-light);">2Ô∏è‚É£ –ü–æ—Å—á–∏—Ç–∞—Ç—å —é–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫—É</div>
                <div class="menu-item" id="stepSettings" style="border:1px solid var(--border-light);">3Ô∏è‚É£ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <div>
                    <div class="card-title">–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</div>
                    <div class="card-subtitle">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –∏ —Ä–µ—Å—É—Ä—Å—ã –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø—Ä–æ–µ–∫—Ç—É</div>
                </div>
            </div>
            <div class="dashboard-grid" id="quickAccessGrid" style="margin-top: 0; grid-template-columns: 1fr; gap: 12px;">
                <!-- Dynamically populated by JS -->
            </div>
        </div>
    </aside>
</div>

    <script src="../assets/js/data-manager.js"></script>
    <script src="../assets/js/app-config.js"></script>
    <script src="../assets/js/sidebar-logic.js"></script>
    <script src="../assets/js/modal.js"></script>
    <script>
        // Auth check
        if (!localStorage.getItem('user')) {
            window.location.href = '../auth/login.html';
        }
        
        function logout() {
            localStorage.removeItem('user');
            window.location.href = '../index.html';
        }

        // Profile Menu Toggle
        const profileBtn = document.getElementById('userProfileBtn');
        const profileMenu = document.getElementById('profileMenu');
        
        profileBtn.addEventListener('click', (e) => {
            if (e.target.closest('.profile-menu')) return;
            profileMenu.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
            if (!profileBtn.contains(e.target)) {
                profileMenu.classList.remove('active');
            }
        });

        function createNewProject() {
            Modal.prompt(
                '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç', 
                '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–æ—Ñ–µ–π–Ω—è"):', 
                (name) => {
                    const project = DataManager.createProject(name);
                    renderHome();
                    // Update sidebar as well
                    if (window.renderSidebar) window.renderSidebar();
                }
            );
        }

        function openProject(id) {
            DataManager.setCurrentProjectId(id);
            window.location.href = '/platform/project.html';
        }

        function openQuickTool(type) {
            DataManager.setCurrentProjectId(null); // Clear project context
            // Find url from config
            const module = AppConfig.modules.find(m => m.id === type);
            if (module) window.location.href = module.url;
        }

        function renderQuickAccess() {
            const grid = document.getElementById('quickAccessGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Filter modules that should show on home
            const quickModules = AppConfig.modules.filter(m => m.showInHome && m.category !== 'main');
            
            quickModules.forEach(m => {
                const el = document.createElement('div');
                el.className = 'stat-card';
                el.style.cursor = 'pointer';
                el.onclick = () => {
                    if (m.category === 'tools') openQuickTool(m.id);
                    else window.location.href = m.url;
                };
                
                // –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∏–∫–æ–Ω–∫–∏ –≤–º–µ—Å—Ç–æ —ç–º–æ–¥–∑–∏
                let iconText = '';
                if (m.id === 'unit') iconText = 'UE';
                else if (m.id === 'pnl') iconText = 'P&L';
                else if (m.id === 'hourly-rate') iconText = 'HR';
                else if (m.id === 'roi-calculator') iconText = 'ROI';
                else if (m.id === 'break-even') iconText = 'BE';
                else iconText = m.id.substring(0, 2).toUpperCase();
                
                el.innerHTML = `
                    <div class="stat-header">
                        <span class="stat-title">${m.category === 'tools' ? '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä' : '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞'}</span>
                    </div>
                    <div class="icon-text">${iconText}</div>
                    <div>
                        <div class="stat-label">${m.title}</div>
                        <div class="stat-desc">${m.desc}</div>
                    </div>
                `;
                
                grid.appendChild(el);
            });
        }

        function showLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                        <div style="font-size: 24px; margin-bottom: 8px;">‚è≥</div>
                        <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                `;
            }
        }

        function renderHome() {
            showLoading('projectsContainer');
            renderQuickAccess();
            const projects = DataManager.getProjects();
            const container = document.getElementById('projectsContainer');
            const user = DataManager.getUser();
            const subtitleEl = document.getElementById('pageSubtitle');
            if (subtitleEl) {
                const hours = new Date().getHours();
                const greeting = hours < 12 ? '–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ' : (hours < 18 ? '–î–æ–±—Ä—ã–π –¥–µ–Ω—å' : '–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä');
                const name = user && user.name ? user.name : (user && user.email ? user.email.split('@')[0] : '–¥—Ä—É–≥');
                subtitleEl.innerText = `${greeting}, ${name}! –í–æ—Ç —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –≤–∞—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏.`;
            }
            
            // Stats
            document.getElementById('totalProjects').innerText = projects.length;
            const totalRev = projects.reduce((sum, p) => sum + (p.stats.revenue || 0), 0);
            document.getElementById('totalRevenue').innerText = DataManager.formatMoney(totalRev);

            const totalProfit = projects.reduce((sum, p) => sum + (p.stats.profit || 0), 0);
            document.getElementById('totalProfit').innerText = DataManager.formatMoney(totalProfit);

            const margins = projects.map(p => (p.stats.margin || 0)).filter(v => !!v);
            const avgMargin = margins.length ? Math.round(margins.reduce((a, b) => a + b, 0) / margins.length) : 0;
            document.getElementById('avgMargin').innerText = DataManager.formatMoney(avgMargin);

            // Onboarding Logic
            if (user && user.onboarding) {
                const stepProjectEl = document.getElementById('stepProject');
                const stepUnitEl = document.getElementById('stepUnit');
                const stepSettingsEl = document.getElementById('stepSettings');

                if (stepProjectEl) {
                    stepProjectEl.style.opacity = '1';
                    stepProjectEl.style.cursor = 'default';
                    stepProjectEl.onclick = null;
                    stepProjectEl.innerHTML = '1Ô∏è‚É£ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç';
                }
                if (stepUnitEl) {
                    stepUnitEl.style.opacity = '1';
                    stepUnitEl.style.cursor = 'default';
                    stepUnitEl.onclick = null;
                    stepUnitEl.innerHTML = '2Ô∏è‚É£ –ü–æ—Å—á–∏—Ç–∞—Ç—å —é–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫—É';
                }
                if (stepSettingsEl) {
                    stepSettingsEl.style.opacity = '1';
                    stepSettingsEl.style.cursor = 'default';
                    stepSettingsEl.onclick = null;
                    stepSettingsEl.innerHTML = '3Ô∏è‚É£ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å';
                }

                const ob = user.onboarding;
                let steps = 0;
                if (ob.projectCreated) {
                    steps++;
                    if (stepProjectEl) {
                        stepProjectEl.style.opacity = '0.5';
                        stepProjectEl.innerHTML += '<div style="color:#10B981; margin-top:4px;">‚úì –ì–æ—Ç–æ–≤–æ</div>';
                    }
                }
                if (ob.unitCalc) {
                    steps++;
                    if (stepUnitEl) {
                        stepUnitEl.style.opacity = '0.5';
                        stepUnitEl.innerHTML += '<div style="color:#10B981; margin-top:4px;">‚úì –ì–æ—Ç–æ–≤–æ</div>';
                    }
                }
                // Check if profile is filled (simple check)
                if (user.company) {
                    steps++;
                    if (stepSettingsEl) {
                        stepSettingsEl.style.opacity = '0.5';
                        stepSettingsEl.innerText = '3Ô∏è‚É£ –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω';
                    }
                } else {
                    // Make settings step clickable
                    if (stepSettingsEl) {
                        stepSettingsEl.style.cursor = 'pointer';
                        stepSettingsEl.onclick = () => window.location.href = '/platform/settings.html';
                    }
                }

                const pct = Math.round((steps / 3) * 100);
                document.getElementById('onboardingPercent').innerText = pct + '%';
                document.getElementById('onboardingBar').style.width = pct + '%';
                
                // Show widget if not complete
                if (pct < 100) {
                    document.getElementById('onboardingWidget').style.display = 'block';
                }
            }

            if (projects.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <span class="empty-icon">üå±</span>
                        <div class="empty-title">–ù–∞—á–Ω–∏—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –±–∏–∑–Ω–µ—Å</div>
                        <div class="empty-desc">–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç, —á—Ç–æ–±—ã —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —é–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫—É –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –º–æ–¥–µ–ª—å.</div>
                        <button class="btn-create-project btn-primary" style="padding: 14px 32px; font-size: 15px;">
    üöÄ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç
</button>
                    </div>
                `;
                return;
            }

            let html = '<div class="project-list">';
            projects.forEach(p => {
                const status = p.unitData || p.pnlData ? '–í —Ä–∞–±–æ—Ç–µ' : '–ß–µ—Ä–Ω–æ–≤–∏–∫';
                const statusColor = p.unitData || p.pnlData ? '#DCFCE7' : '#F1F5F9';
                const statusText = p.unitData || p.pnlData ? '#166534' : '#64748B';

                html += `
                    <div class="project-item" onclick="openProject('${p.id}')">
                        <div class="project-meta">
                            <div class="project-avatar">üöÄ</div>
                            <div class="project-details">
                                <div>${p.name}</div>
                                <div>–û–±–Ω–æ–≤–ª–µ–Ω ${DataManager.formatDate(p.updated)}</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 24px;">
                            <div style="text-align: right;">
                                <div style="font-size: 13px; color: var(--text-tertiary);">–í—ã—Ä—É—á–∫–∞</div>
                                <div style="font-weight: 600;">${DataManager.formatMoney(p.stats.revenue || 0)}</div>
                            </div>
                            <span style="padding: 4px 10px; border-radius: 100px; font-size: 11px; font-weight: 600; background: ${statusColor}; color: ${statusText};">${status}</span>
                            <span style="color: var(--text-tertiary);">‚Üí</span>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        }

        document.addEventListener('DOMContentLoaded', renderHome);

        function updateDashboard() {
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã –∏–∑ DataManager –∏–ª–∏ localStorage
            let projects = [];
            try {
                if (typeof DataManager !== 'undefined' && DataManager.getProjects) {
                    projects = DataManager.getProjects() || [];
                } else {
                    projects = JSON.parse(localStorage.getItem('projects') || '[]');
                }
            } catch (e) {
                projects = JSON.parse(localStorage.getItem('projects') || '[]');
            }
            
            // –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
            const totalProjectsEl = document.getElementById('totalProjects');
            if (totalProjectsEl) {
                totalProjectsEl.innerText = projects.length;
            }
            
            // –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ (–ø–ª–∞–Ω) ‚Äî —Å—É–º–º–∞ –ø–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º
            let totalRevenue = 0;
            let totalProfit = 0;
            let totalMargin = 0;
            let projectsWithMargin = 0;
            
            projects.forEach(project => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
                let projectData = null;
                
                // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DataManager (project.unitData –∏–ª–∏ project.unit)
                if (project.unitData) {
                    projectData = project.unitData;
                } else if (project.unit) {
                    projectData = project.unit;
                }
                // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ localStorage (project.unitEconomics)
                else if (project.unitEconomics) {
                    projectData = project.unitEconomics;
                }
                
                if (projectData) {
                    totalRevenue += projectData.revenue || 0;
                    totalProfit += projectData.profit || 0;
                    
                    if (projectData.margin) {
                        totalMargin += projectData.margin;
                        projectsWithMargin++;
                    }
                }
            });
            
            const totalRevenueEl = document.getElementById('totalRevenue');
            if (totalRevenueEl) {
                if (typeof DataManager !== 'undefined' && DataManager.formatMoney) {
                    totalRevenueEl.innerText = DataManager.formatMoney(totalRevenue);
                } else {
                    totalRevenueEl.innerText = totalRevenue.toLocaleString('ru-RU') + ' ‚ÇΩ';
                }
            }
            
            const totalProfitEl = document.getElementById('totalProfit');
            if (totalProfitEl) {
                if (typeof DataManager !== 'undefined' && DataManager.formatMoney) {
                    totalProfitEl.innerText = DataManager.formatMoney(totalProfit);
                } else {
                    totalProfitEl.innerText = totalProfit.toLocaleString('ru-RU') + ' ‚ÇΩ';
                }
            }
            
            const avgMarginEl = document.getElementById('avgMargin');
            if (avgMarginEl) {
                const avgMargin = projectsWithMargin > 0 ? Math.round(totalMargin / projectsWithMargin) : 0;
                if (typeof DataManager !== 'undefined' && DataManager.formatMoney) {
                    avgMarginEl.innerText = DataManager.formatMoney(avgMargin);
                } else {
                    avgMarginEl.innerText = avgMargin.toLocaleString('ru-RU') + ' ‚ÇΩ';
                }
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        updateDashboard();

        // Update user profile display
        const user = DataManager.getUser();
        if (user) {
            const avatarEl = document.querySelector('.avatar');
            const nameEl = document.querySelector('.user-name');
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–º—è: –ª–∏–±–æ –∏–∑ user.name, –ª–∏–±–æ –∏–∑ email
            const displayName = user.name || (user.email ? user.email.split('@')[0] : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');
            
            if (avatarEl) {
                avatarEl.textContent = displayName.charAt(0).toUpperCase();
            }
            if (nameEl) {
                nameEl.textContent = displayName;
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage
        const userName = localStorage.getItem('userName');
        const userEmail = localStorage.getItem('userEmail');

        if (userName) {
            document.getElementById('user-name').innerText = userName;
        } else if (userEmail) {
            const namePart = userEmail.split('@')[0];
            document.getElementById('user-name').innerText = namePart.charAt(0).toUpperCase() + namePart.slice(1);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ–∫–∞ –±–µ–∑ backend):
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        if (!isLoggedIn) {
            // –ï—Å–ª–∏ –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –ø–æ–∫–∞, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
            // window.location.href = '/auth/login.html';
        }

        // Burger Menu Functionality
        const burger = document.getElementById('burger-menu');
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.createElement('div');
        overlay.className = 'overlay';
        document.body.appendChild(overlay);

        burger.addEventListener('click', () => {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
            burger.classList.toggle('active');
        });

        overlay.addEventListener('click', () => {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            burger.classList.remove('active');
        });

        // Create Project Button Handler
        document.querySelectorAll('.btn-create-project').forEach(button => {
            button.addEventListener('click', () => {
                const projectName = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:');
                if (projectName) {
                    // –í—Ä–µ–º–µ–Ω–Ω–æ: –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç –≤ localStorage
                    const projects = JSON.parse(localStorage.getItem('projects') || '[]');
                    const newProject = {
                        id: Date.now(),
                        name: projectName,
                        created: new Date().toISOString(),
                        unitEconomics: {},
                        pnl: {},
                        roi: {}
                    };
                    projects.push(newProject);
                    localStorage.setItem('projects', JSON.stringify(projects));
                    localStorage.setItem('currentProject', newProject.id);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∂–µ—Ç—ã –ø–µ—Ä–µ–¥ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º
                    updateDashboard();
                    
                    // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —é–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –ø—Ä–æ–µ–∫—Ç–∞
                    window.location.href = '/platform/tools/unit-economics.html?project=' + newProject.id;
                }
            });
        });
    </script>
</body>
</html>
